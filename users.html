<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" crossorigin="anonymous">


<!-- Latest compiled and minified JavaScript -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" crossorigin="anonymous"></script>
	<title>Freelancer</title>

	
</head>
<body>

<!--Nav Bar-->
	<nav class="navbar navbar-expand-lg navbar-light bg-light">
  	<a class="navbar-brand" href="#">Freelancer</a>
  	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  	</button>
  	<div class="collapse navbar-collapse" id="navbarText">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item ">
        <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">About</a>
      </li>
      <li class="nav-item active">
        <a class="nav-link" href="#">Users</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">My Profile</a>
      </li>
    </ul>
    <span class="navbar-text">
    </span>
  </div>
</nav>
<!--End of navBar -->


	<div class="row">

<!-- User One -->
  		<div class="col-sm-4">
		<div class="card mt-4 ml-4" style="width: 18rem;">
  <img class="card-img-top" src="pic5.jpg" alt="Card image cap">
  <div class="card-body">
    <h5 class="card-title">Rashan - Software Developer</h5>
     <p class="card-text" id='money2' style="float: right" ></p>
    <p class="card-text">Bank Account</p>
    <p class="card-text" id='createdJobs2' style="float: right" ></p>
    <p class="card-text" > Jobs Created</p>
    <p class="card-text" id='jobsTaken2' style="float: right" ></p>
    <p class="card-text">Jobs Taken</p>
    <p class="card-text" id='reviews2' style="float: right" ></p>
    <p class="card-text">Reviews</p>
    <p class="card-text" id='counter-value'></p>
    <button class="btn btn-primary" id='createJob2'>Create Job</button>
    <button class="btn btn-primary" id='takeJob2'>Take Job</button>
  </div>
</div>
  </div>

<!-- User Two -->
  <div class="col-sm-4">
<div class="card mt-4 ml-4" style="width: 18rem;">
  <img class="card-img-top" src="pic3.jpg" alt="Card image cap">
  <div class="card-body">
    <h5 class="card-title">Jessica - Software Developer</h5>
    <p class="card-text" id='money' style="float: right" ></p>
    <p class="card-text" >Bank Account</p>
    <p class="card-text" id='createdJobs' style="float: right" ></p>
    <p class="card-text"> Jobs Created</p>
    <p class="card-text"  id='jobsTaken' style="float: right" ></p>
    <p class="card-text" >Jobs Taken</p>
    <p class="card-text" id='reviews' style="float: right" ></p>
    <p class="card-text" >Reviews</p>
    <button class="btn btn-primary" id='createJob'>Create Job</button>
    <button class="btn btn-primary" id='takeJob'>Take Job</button>
  </div>
</div>
		</div>
	</div>


	<!--<script src="./web3.min.js"></script>-->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
  <script src="web3.min.js"></script>

<script>
    var contract;

    $(document).ready(function() {
      initContract();
      getValue1();
      getValue2();
      getValue3();
      getValue4();
    })

    console.log("hi");

    //metamask and test ether needed
    function initContract() {
      //var Web3 = require('web3');

      web3 = new Web3(web3.currentProvider);
      var address = "0xd0a4ea548538a8a62cbae1b6bb1674222d202853";
      var abi =[
  {
    "constant": true,
    "inputs": [],
    "name": "getMoney2",
    "outputs": [
      {
        "name": "",
        "type": "int256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getReviews",
    "outputs": [
      {
        "name": "",
        "type": "int256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "createJob2",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getCreatedJobs2",
    "outputs": [
      {
        "name": "",
        "type": "int256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getTakenJobs",
    "outputs": [
      {
        "name": "",
        "type": "int256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "takeJob2",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getMoney",
    "outputs": [
      {
        "name": "",
        "type": "int256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "createJob1",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "takeJob1",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getCreatedJobs",
    "outputs": [
      {
        "name": "",
        "type": "int256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getTakenJobs2",
    "outputs": [
      {
        "name": "",
        "type": "int256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getReviews2",
    "outputs": [
      {
        "name": "",
        "type": "int256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "constructor"
  }
];
      

      // instantiating new contract
      contract =  new web3.eth.Contract(abi, address);
    }

    function getValue1() {
      contract.methods.getCreatedJobs().call().then((result) => {
        $('#createdJobs').html(result);
      })

        contract.methods.getCreatedJobs2().call().then((result) => {
        $('#createdJobs2').html(result);
      })
      
    }

     function getValue2() {
      contract.methods.getMoney().call().then((result) => {
        $('#money').html(result);
      })

      contract.methods.getMoney2().call().then((result) => {
        $('#money2').html(result);
      })
      
      
    }

     function getValue3() {
      contract.methods.getTakenJobs().call().then((result) => {
        $('#jobsTaken').html(result);
      })

       contract.methods.getTakenJobs2().call().then((result) => {
        $('#jobsTaken2').html(result);
      })
      
    }

      function getValue4() {
      contract.methods.getReviews().call().then((result) => {
        $('#reviews').html(result);
      })

      contract.methods.getReviews2().call().then((result) => {
        $('#reviews2').html(result);
      })
      
    }


    $('#createJob').click(function() {
      web3.eth.getAccounts().then(function(accounts) {
        var acct = accounts[0];
        return contract.methods.createJob1().send({from: acct});
      }).then(function(tx) {
        console.log(tx);
        var curr = parseInt($('#createdJobs').html());
        $('#createJobs').html(curr + 1);
      }).catch(function(err) {
        console.lg(err);
      })
    })


    $('#takeJob').click(function() {
      web3.eth.getAccounts().then(function(accounts) {
        var acct = accounts[0];
        return contract.methods.takeJob2().send({from: acct});
      }).then(function(tx) {
        console.log(tx);
        var curr = parseInt($('#jobsTaken').html());
        $('#jobsTaken').html(curr + 1);
      }).catch(function(err) {
        console.lg(err);
      })
    })


    $('#createJob2').click(function() {
      web3.eth.getAccounts().then(function(accounts) {
        var acct = accounts[1];
        return contract.methods.createJob2().send({from: acct});
      }).then(function(tx) {
        console.log(tx);
        var curr = parseInt($('#createdJobs2').html());
        $('#createJobs2').html(curr + 1);
      }).catch(function(err) {
        console.lg(err);
      })
    })


    $('#takeJob2').click(function() {
      web3.eth.getAccounts().then(function(accounts) {
        var acct = accounts[1];
        return contract.methods.takeJob2().send({from: acct});
      }).then(function(tx) {
        console.log(tx);
        var curr = parseInt($('#jobsTaken2').html());
        $('#jobsTaken2').html(curr + 1);
      }).catch(function(err) {
        console.lg(err);
      })
    })


  </script>






</body>
<html>